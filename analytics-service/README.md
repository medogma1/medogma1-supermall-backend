# خدمة التحليلات (Analytics Service)

خدمة التحليلات هي جزء من نظام SuperMall للتجارة الإلكترونية. تقدم هذه الخدمة تحليلات للمبيعات والعملاء والمخزون، بالإضافة إلى تحليلات أداء التطبيق.

## الميزات

### تحليلات الأعمال
- **تحليلات المبيعات**: إجمالي الإيرادات، إجمالي الطلبات، متوسط قيمة الطلب، الإيرادات حسب الفئة، الطلبات حسب الحالة، المبيعات اليومية
- **تحليلات العملاء**: إجمالي العملاء، العملاء الجدد، العملاء المتكررين، معدل الاحتفاظ بالعملاء، العملاء حسب المنطقة
- **تحليلات المخزون**: المنتجات غير المتوفرة، المخزون حسب الفئة، المنتجات الأكثر مبيعًا، المنتجات الأقل مبيعًا

### تحليلات الأداء
- **أداء التطبيق**: وقت التحميل، استخدام الذاكرة، استخدام وحدة المعالجة المركزية، وقت الاستجابة، رمز الحالة
- **سجل الأخطاء**: نوع الخطأ، رسالة الخطأ، تتبع المكدس، نقطة النهاية، وكيل المستخدم، عنوان IP، معرف المستخدم، قاتل
- **مشاركة المستخدم**: معرف المستخدم، معرف الجلسة، وقت البدء، وقت الانتهاء، المدة، الصفحات التي تمت زيارتها، الأحداث، الجهاز، المنصة، المتصفح
- **أداء API**: نقطة النهاية، الطريقة، وقت الاستجابة، رمز الحالة، حجم الطلب، حجم الاستجابة، معرف المستخدم، عنوان IP

## واجهات برمجة التطبيقات (APIs)

### تحليلات الأعمال
- `GET /analytics/sales`: الحصول على تحليلات المبيعات
- `PUT /analytics/sales/:id`: تحديث تحليلات المبيعات
- `GET /analytics/customers`: الحصول على تحليلات العملاء
- `GET /analytics/inventory`: الحصول على تحليلات المخزون

### تحليلات الأداء
- `POST /performance/app`: تسجيل أداء التطبيق
- `GET /performance/app`: الحصول على إحصائيات أداء التطبيق
- `POST /performance/error`: تسجيل خطأ
- `GET /performance/errors`: الحصول على إحصائيات الأخطاء
- `POST /performance/engagement`: تسجيل مشاركة المستخدم
- `GET /performance/engagement`: الحصول على إحصائيات مشاركة المستخدم
- `POST /performance/api`: تسجيل أداء API
- `GET /performance/api`: الحصول على إحصائيات أداء API

## التثبيت والتشغيل

1. تثبيت التبعيات:
```bash
npm install
```

2. إنشاء ملف `.env` وتعيين المتغيرات البيئية:
```
PORT=5010
MONGO_URI=mongodb://127.0.0.1:27017/analytics_db
```

3. تشغيل الخدمة:
```bash
npm start
```

أو في وضع التطوير:
```bash
npm run dev
```

## التكامل مع الخدمات الأخرى

تتكامل خدمة التحليلات مع الخدمات الأخرى في نظام SuperMall من خلال بوابة API. يمكن للخدمات الأخرى إرسال بيانات التحليلات إلى هذه الخدمة، ويمكن للتطبيق الأمامي استرداد البيانات التحليلية لعرضها في لوحات المعلومات.