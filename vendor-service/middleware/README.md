# وسائط المصادقة في خدمة البائعين

يحتوي هذا المجلد على الوسائط البرمجية (Middleware) المستخدمة للمصادقة والتحقق من الصلاحيات في خدمة البائعين.

## الملفات المتوفرة

### 1. authMiddleware.js

وسيط للتحقق من صحة رمز JWT المرسل مع الطلب. يقوم بما يلي:
- التحقق من وجود رمز JWT في رأس الطلب
- التحقق من صحة الرمز باستخدام المفتاح السري
- إضافة بيانات المستخدم المشفرة إلى كائن الطلب (req.user)

### 2. roleMiddleware.js

وسيط للتحقق من أدوار المستخدمين. يستخدم للتأكد من أن المستخدم لديه الصلاحيات المناسبة للوصول إلى مسارات معينة.

### 3. vendorOwnershipMiddleware.js

وسيط للتحقق من ملكية البائع للخدمات. يستخدم للتأكد من أن البائع يمكنه فقط تعديل أو حذف الخدمات التي يملكها.

## كيفية الاستخدام

```javascript
// مثال على استخدام وسائط المصادقة
const authMiddleware = require('../middleware/authMiddleware');
const roleMiddleware = require('../middleware/roleMiddleware');

// مسار محمي يتطلب مصادقة
router.get('/protected', authMiddleware, (req, res) => {
  res.json({ message: 'تم الوصول إلى المسار المحمي', user: req.user });
});

// مسار محمي يتطلب دور محدد (مشرف)
router.get('/admin-only', authMiddleware, roleMiddleware('admin'), (req, res) => {
  res.json({ message: 'تم الوصول إلى مسار المشرف' });
});

// مسار محمي يتطلب أحد الأدوار المحددة (مشرف أو بائع)
router.get('/admin-or-vendor', authMiddleware, roleMiddleware('admin', 'vendor'), (req, res) => {
  res.json({ message: 'تم الوصول إلى مسار المشرف أو البائع' });
});
```

## ملاحظات أمنية

- يجب التأكد من أن المفتاح السري (JWT_SECRET) آمن وغير معروف لأي شخص خارج الفريق المطور.
- يجب استخدام HTTPS لضمان تشفير البيانات المرسلة بين العميل والخادم.
- يجب تطبيق وسيط المصادقة على جميع المسارات التي تتطلب حماية.