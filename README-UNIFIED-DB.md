# توحيد قاعدة البيانات في مشروع SuperMall

## نظرة عامة

تم تحديث مشروع SuperMall لاستخدام قاعدة بيانات موحدة واحدة (`supermall`) بدلاً من قواعد بيانات متعددة. هذا التغيير يبسط إدارة البيانات ويحسن الأداء والتكامل بين الخدمات المختلفة.

## التغييرات الرئيسية

1. **توحيد إعدادات قاعدة البيانات**: تم تحديث جميع ملفات `.env` في كل خدمة لاستخدام نفس إعدادات قاعدة البيانات.

2. **ترحيل البيانات من MongoDB إلى MySQL**: تم إنشاء جداول MySQL جديدة للخدمات التي كانت تستخدم MongoDB سابقًا (التحليلات، الدردشة، الإشعارات، الدعم).

3. **تحديث سكريبت إعداد قاعدة البيانات**: تم تحديث `setup-database.js` لإنشاء جميع الجداول اللازمة في قاعدة البيانات الموحدة.

## الخدمات المتأثرة

- **خدمة المصادقة (auth-service)**: تم تغيير قاعدة البيانات من `supermall_auth` إلى `supermall`.
- **خدمة التحليلات (analytics-service)**: تم التحويل من MongoDB إلى MySQL.
- **خدمة الدردشة (chat-service)**: تم التحويل من MongoDB إلى MySQL.
- **خدمة الإشعارات (notification-service)**: تم التحويل من MongoDB إلى MySQL.
- **خدمة الدعم (support-service)**: تم التحويل من MongoDB إلى MySQL.

## كيفية تطبيق التغييرات

1. **إعداد قاعدة البيانات الموحدة**:

   ```bash
   node utils/setup-database.js
   ```

   هذا السكريبت سيقوم بإنشاء قاعدة البيانات `supermall` وجميع الجداول اللازمة.

2. **إعادة تشغيل جميع الخدمات**:

   ```bash
   start-all.bat
   ```

## ملاحظات هامة

- **البيانات الموجودة**: إذا كان لديك بيانات موجودة في قواعد البيانات القديمة، فستحتاج إلى ترحيلها يدويًا إلى قاعدة البيانات الجديدة.
- **تغييرات الكود**: قد تحتاج بعض الخدمات إلى تعديلات إضافية في الكود للتعامل مع قاعدة البيانات الجديدة، خاصة الخدمات التي تم تحويلها من MongoDB إلى MySQL.

## فوائد التوحيد

- **إدارة أسهل**: قاعدة بيانات واحدة بدلاً من عدة قواعد بيانات.
- **استعلامات أكثر كفاءة**: يمكن الآن إجراء استعلامات تربط بين بيانات من خدمات مختلفة.
- **نسخ احتياطي أسهل**: عملية واحدة للنسخ الاحتياطي واستعادة البيانات.
- **تناسق البيانات**: ضمان تناسق البيانات بين جميع الخدمات.